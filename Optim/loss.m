function [ l,predict ] = loss( X,Y,W,layer1_size,layer2_size)
% Calc the loss of the network
w1 = W([1:784 * layer1_size]);
b1 = W([784 * layer1_size + 1: ...
    784 * layer1_size + layer1_size]);
w2 = W([784 * layer1_size + layer1_size + 1: ...
    784 * layer1_size + layer1_size + layer1_size * layer2_size]);
b2 = W([784 * layer1_size + layer1_size + layer1_size * layer2_size + 1: ...
    784 * layer1_size + layer1_size + layer1_size * layer2_size + layer2_size]);
w3 = W([784 * layer1_size + layer1_size + layer1_size * ...
    layer2_size + layer2_size + 1 : ...
    784 * layer1_size + layer1_size + layer1_size * ...
    layer2_size + layer2_size + 10 * layer2_size]);
b3 = W([784 * layer1_size + layer1_size + layer1_size * ...
    layer2_size + layer2_size + 10 * layer2_size + 1: ...
    784 * layer1_size + layer1_size + layer1_size * ...
    layer2_size + layer2_size + 10 * layer2_size + 10]);
w1 = reshape(w1,784,layer1_size);
w2 = reshape(w2,layer1_size,layer2_size);
w3 = reshape(w3,layer2_size,10);
[y, softmax,predict] = gen_network(X,w1,w2,w3,b1,b2,b3);
s = -log(softmax);
l = sum(dot(Y',s'));
end